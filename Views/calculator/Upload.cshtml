@{
    ViewData["Title"] = "Upload CSV File";
}

<h1 class="text-center mb-4">Upload CSV</h1>

<form asp-controller="Calculator" asp-action="UploadCsv" method="post" enctype="multipart/form-data" id="uploadForm">
    <div id="dropArea" style="border: 2px dashed #007bff; padding: 50px; text-align: center; cursor: pointer; border-radius: 10px;">
        <i style="font-size: 48px; color: #007bff;" class="bi bi-cloud-arrow-up-fill"></i>
        <p style="margin-top: 10px;">Drag &amp; Drop your CSV file here or click to browse</p>
        <input type="file" name="file" id="fileInput" style="display: none;" />
    </div>
    <button type="submit" style="margin-top: 20px;" class="btn btn-primary d-block mx-auto">Upload</button>
</form>

<script>
    // Prevent the browser’s default dragover and drop behaviors on the whole window
    window.addEventListener('dragover', function (e) {
        e.preventDefault();
        e.stopPropagation();
    });
    window.addEventListener('drop', function (e) {
        e.preventDefault();
        e.stopPropagation();
    });

    const dropArea = document.getElementById('dropArea');
    const fileInput = document.getElementById('fileInput');

    // When the user clicks the drop area, open the file picker
    dropArea.addEventListener('click', () => fileInput.click());

    // When dragging a file over the drop area, highlight it
    dropArea.addEventListener('dragover', (e) => {
        e.preventDefault();
            dropArea.style.backgroundColor = '#e9ecef';@{
        ViewData["Title"] = "Upload CSV File";
    }

    <h1 class="text-center mb-4">Upload CSV</h1>

    <form asp-controller="Calculator" asp-action="UploadCsv" method="post" enctype="multipart/form-data" id="uploadForm">
        <div id="dropArea"
             style="border: 2px dashed #007bff; padding: 50px; text-align: center; cursor: pointer; border-radius: 10px;">
            <i style="font-size: 48px; color: #007bff;" class="bi bi-cloud-arrow-up-fill"></i>
            <p style="margin-top: 10px;">Drag &amp; Drop your CSV file here or click to browse</p>
            <input type="file" name="file" id="fileInput" style="display: none;" />
        </div>
        <button type="submit" style="margin-top: 20px;" class="btn btn-primary d-block mx-auto">Upload</button>
    </form>

    <script>
        // 1. Prevent default drag/drop on the entire window
        window.addEventListener('dragover', function (e) {
            e.preventDefault();
            e.stopPropagation();
        }, false);

        window.addEventListener('drop', function (e) {
            e.preventDefault();
            e.stopPropagation();
        }, false);

        // 2. Now hook our dropArea
        const dropArea = document.getElementById('dropArea');
        const fileInput = document.getElementById('fileInput');
        const uploadForm = document.getElementById('uploadForm');

        // click on area → open file picker
        dropArea.addEventListener('click', () => fileInput.click());

        // drag over area → highlight
        dropArea.addEventListener('dragover', function (e) {
            e.preventDefault();
            dropArea.style.backgroundColor = '#e9ecef';
        }, false);

        // drag leave area → remove highlight
        dropArea.addEventListener('dragleave', function (e) {
            e.preventDefault();
            dropArea.style.backgroundColor = 'transparent';
        }, false);

        // drop on area → set files + submit
        dropArea.addEventListener('drop', function (e) {
            e.preventDefault();
            dropArea.style.backgroundColor = 'transparent';
            fileInput.files = e.dataTransfer.files;
            uploadForm.submit();
        }, false);
</script>

    });

    // When the file leaves the drop area, remove the highlight
    dropArea.addEventListener('dragleave', (e) => {
        e.preventDefault();
        dropArea.style.backgroundColor = 'transparent';
    });

    // When a file is dropped into the area, set it on the file input and submit the form
    dropArea.addEventListener('drop', (e) => {
        e.preventDefault();
        dropArea.style.backgroundColor = 'transparent';
        fileInput.files = e.dataTransfer.files;
        document.getElementById('uploadForm').submit();
    });
</script>
